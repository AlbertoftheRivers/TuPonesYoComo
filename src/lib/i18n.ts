import AsyncStorage from '@react-native-async-storage/async-storage';

const LANGUAGE_KEY = '@tuponesyocomo:language';

export type SupportedLanguage = 'es' | 'ca' | 'fr' | 'en' | 'pt';

let currentLanguage: SupportedLanguage = 'es';

export const translations: Record<SupportedLanguage, Record<string, string>> = {
  es: {
    // Home Screen
    appName: 'TuPonesYoComo',
    selectCategory: 'Selecciona una categor√≠a para ver recetas',
    addRecipe: 'A√±adir Receta',
    
    // Navigation
    recipeDetails: 'Detalles de la Receta',
    addRecipeTitle: 'A√±adir Receta',
    editRecipe: 'Editar Receta',
    userGuide: 'Gu√≠a de Usuario',
    
    // Add/Edit Recipe Screen
    recipeTitle: 'T√≠tulo de la Receta',
    mainProtein: 'Prote√≠na Principal',
    cuisines: 'Cocinas',
    rawText: 'Texto de la Receta',
    analyze: 'Analizar',
    save: 'Guardar',
    cancel: 'Cancelar',
    delete: 'Eliminar',
    edit: 'Editar',
    servings: 'Porciones',
    totalTime: 'Tiempo Total',
    ovenTime: 'Tiempo de Horno',
    oven: 'Horno',
    ingredients: 'Ingredientes',
    steps: 'Pasos',
    gadgets: 'Utensilios',
    for: 'Para',
    adjustedFrom: 'Ajustado de',
    portions: 'porciones',
    min: 'min',
    
    // Actions
    record: 'Grabar',
    stop: 'Detener',
    takePhoto: 'Tomar Foto',
    selectFromGallery: 'Seleccionar de Galer√≠a',
    scanRecipe: 'Escanear Receta',
    chooseOption: 'Elige una opci√≥n para escanear la receta',
    
    // Modals
    addCategory: 'A√±adir Categor√≠a',
    addNewCategory: 'A√±adir Nueva Categor√≠a',
    categoryName: 'Nombre de la categor√≠a',
    categoryIcon: 'Icono (emoji)',
    add: 'A√±adir',
    addNew: 'A√±adir',
    select: 'Seleccionar',
    other: 'Otra...',
    addCuisine: 'A√±adir Cocina',
    addNewCuisine: 'A√±adir Nueva Cocina',
    cuisineName: 'Nombre de la cocina',
    cuisineFlag: 'Bandera (emoji)',
    example: 'Ej:',
    optional: 'Opcional:',
    customizeEmoji: 'personaliza el emoji',
    pasteOrWrite: 'Pega o escribe tu receta aqu√≠... O usa üì∑ para escanear o üé§ para dictar',
    analysisPreview: 'Vista Previa del An√°lisis',
    total: 'Total',
    nA: 'N/A',
    
    // Messages
    success: '√âxito',
    error: 'Error',
    categoryAdded: 'Categor√≠a a√±adida',
    cuisineAdded: 'Cocina a√±adida',
    recipeSaved: 'Receta guardada',
    recipeDeleted: 'Receta eliminada',
    recipeSavedSuccess: '¬°Receta guardada correctamente!',
    viewRecipe: 'Ver Receta',
    backToMainMenu: 'Volver al Men√∫ Principal',
    pleaseEnterName: 'Por favor ingresa un nombre',
    pleaseEnterIcon: 'Por favor ingresa un icono',
    pleaseEnterFlag: 'Por favor ingresa un emoji de bandera',
    categoryExists: 'Esta categor√≠a ya existe',
    cuisineExists: 'Esta cocina ya existe',
    
    // Recipe List
    noRecipes: 'No hay recetas en esta categor√≠a',
    noRecipesFound: 'No se encontraron recetas',
    tryOtherSearch: 'Intenta con otros t√©rminos de b√∫squeda',
    tapAddRecipe: 'Toca "A√±adir Receta" para crear tu primera receta',
    searchPlaceholder: 'Buscar por nombre, cocina o ingrediente...',
    recipesCount: 'receta',
    recipesCountPlural: 'recetas',
    pullToRefresh: 'Tira para actualizar',
    
    // Common UI
    title: 'T√≠tulo',
    name: 'Nombre',
    add: 'A√±adir',
    save: 'Guardar',
    cancel: 'Cancelar',
    ok: 'OK',
    reset: 'Reset',
    loading: 'Cargando...',
    error: 'Error',
    success: '√âxito',
    connectingToAI: 'Conectando al servidor de IA...',
    processingResponse: 'Procesando respuesta...',
    recipeAnalyzed: '¬°Receta analizada correctamente!',
    analysisError: 'Error de An√°lisis',
    checkConnection: 'Error al analizar la receta. Por favor verifica la conexi√≥n con el servidor.',
    verifyConfig: 'Verificar Configuraci√≥n',
    apiConfig: 'Configuraci√≥n de API',
    audioPermissions: 'Permisos de Audio',
    microphonePermission: 'Se necesitan permisos de micr√≥fono para usar la funci√≥n de dictado por voz.',
    cameraPermission: 'Se necesitan permisos de c√°mara para tomar fotos.',
    galleryPermission: 'Se necesitan permisos de galer√≠a para seleccionar im√°genes.',
    audioNotAvailable: 'La grabaci√≥n de audio no est√° disponible en este navegador. Por favor usa Chrome, Edge o Safari.',
    couldNotCreateRecorder: 'No se pudo crear el grabador de audio.',
    couldNotStartRecording: 'No se pudo iniciar la grabaci√≥n. Por favor verifica los permisos del micr√≥fono.',
    transcribing: 'Transcribiendo',
    processingAudio: 'Procesando tu audio con Whisper...',
    audioTranscribed: 'Audio transcrito correctamente',
    transcriptionError: 'Error de Transcripci√≥n',
    errorTranscribing: 'Error al transcribir el audio. Por favor verifica la conexi√≥n con el servidor.',
    processing: 'Procesando',
    extractingText: 'Extrayendo texto de la imagen...',
    textExtracted: 'Texto extra√≠do correctamente de la imagen',
    ocrError: 'Error de OCR',
    errorExtractingText: 'Error al extraer texto de la imagen. Por favor verifica la conexi√≥n con el servidor.',
    pleaseEnterTitle: 'Por favor ingresa un t√≠tulo para la receta.',
    pleaseEnterText: 'Por favor ingresa el texto de la receta.',
    pleaseAnalyzeFirst: 'Por favor analiza la receta primero antes de guardar.',
    pleaseSelectCategory: 'Por favor selecciona una categor√≠a principal.',
    errorSaving: 'Error al guardar la receta. Por favor verifica la conexi√≥n con Supabase e intenta de nuevo.',
    connectionError: 'Error de conexi√≥n. Por favor verifica tu conexi√≥n a internet.',
    authError: 'Error de autenticaci√≥n. Por favor verifica la configuraci√≥n de Supabase.',
    noIngredientsYet: 'Sin ingredientes a√∫n. Ejecuta el an√°lisis de IA primero.',
    noStepsYet: 'Sin pasos a√∫n. Ejecuta el an√°lisis de IA primero.',
    errorLoadingRecipe: 'Error al cargar la receta. Por favor intenta de nuevo.',
    errorUpdatingRecipe: 'Error al actualizar la receta. Por favor intenta de nuevo.',
    
    // Language
    language: 'Idioma',
    selectLanguage: 'Seleccionar Idioma',
    spanish: 'Espa√±ol',
    catalan: 'Catal√°n',
    french: 'Franc√©s',
    english: 'Ingl√©s',
    portuguese: 'Portugu√©s',
  },
  ca: {
    appName: 'TuPonesYoComo',
    selectCategory: 'Selecciona una categoria per veure receptes',
    addRecipe: 'Afegir Recepta',
    recipeDetails: 'Detalls de la Recepta',
    addRecipeTitle: 'Afegir Recepta',
    editRecipe: 'Editar Recepta',
    userGuide: 'Guia d\'Usuari',
    recipeTitle: 'T√≠tol de la Recepta',
    mainProtein: 'Prote√Øna Principal',
    cuisines: 'Cuines',
    rawText: 'Text de la Recepta',
    analyze: 'Analitzar',
    save: 'Desar',
    cancel: 'Cancel¬∑lar',
    delete: 'Eliminar',
    deleteRecipe: 'Eliminar Recepta',
    edit: 'Editar',
    servings: 'Racions',
    totalTime: 'Temps Total',
    ovenTime: 'Temps de Forn',
    ingredients: 'Ingredients',
    steps: 'Passos',
    gadgets: 'Eines',
    oven: 'Forn',
    for: 'Per a',
    adjustedFrom: 'Ajustat de',
    portions: 'racions',
    min: 'min',
    record: 'Enregistrar',
    stop: 'Aturar',
    takePhoto: 'Fer Foto',
    selectFromGallery: 'Seleccionar de la Galeria',
    scanRecipe: 'Escanejar Recepta',
    chooseOption: 'Tria una opci√≥ per escanejar la recepta',
    addCategory: 'Afegir Categoria',
    addNewCategory: 'Afegir Nova Categoria',
    categoryName: 'Nom de la categoria',
    categoryIcon: 'Icona (emoji)',
    add: 'Afegir',
    addNew: 'Afegir',
    select: 'Seleccionar',
    other: 'Altres...',
    addCuisine: 'Afegir Cuina',
    addNewCuisine: 'Afegir Nova Cuina',
    cuisineName: 'Nom de la cuina',
    cuisineFlag: 'Bandera (emoji)',
    example: 'Ex:',
    optional: 'Opcional:',
    customizeEmoji: 'personalitza l\'emoji',
    pasteOrWrite: 'Enganxa o escriu la teva recepta aqu√≠... O usa üì∑ per escanejar o üé§ per dictar',
    analysisPreview: 'Vista Pr√®via de l\'An√†lisi',
    total: 'Total',
    nA: 'N/A',
    success: '√àxit',
    error: 'Error',
    categoryAdded: 'Categoria afegida',
    cuisineAdded: 'Cuina afegida',
    recipeSaved: 'Recepta desada',
    recipeDeleted: 'Recepta eliminada',
    recipeSavedSuccess: 'Recepta desada correctament!',
    viewRecipe: 'Veure Recepta',
    backToMainMenu: 'Tornar al Men√∫ Principal',
    pleaseEnterName: 'Si us plau, introdueix un nom',
    pleaseEnterIcon: 'Si us plau, introdueix una icona',
    pleaseEnterFlag: 'Si us plau, introdueix un emoji de bandera',
    categoryExists: 'Aquesta categoria ja existeix',
    cuisineExists: 'Aquesta cuina ja existeix',
    noRecipes: 'No hi ha receptes en aquesta categoria',
    noRecipesFound: 'No s\'han trobat receptes',
    tryOtherSearch: 'Intenta amb altres termes de cerca',
    tapAddRecipe: 'Toca "Afegir Recepta" per crear la teva primera recepta',
    searchPlaceholder: 'Buscar per nom, cuina o ingredient...',
    recipesCount: 'recepta',
    recipesCountPlural: 'receptes',
    pullToRefresh: 'Tira per actualitzar',
    
    // Common UI
    title: 'T√≠tol',
    name: 'Nom',
    add: 'Afegir',
    save: 'Desar',
    cancel: 'Cancel¬∑lar',
    ok: 'OK',
    reset: 'Restablir',
    loading: 'Carregant...',
    error: 'Error',
    success: '√àxit',
    connectingToAI: 'Connectant al servidor d\'IA...',
    processingResponse: 'Processant resposta...',
    recipeAnalyzed: 'Recepta analitzada correctament!',
    analysisError: 'Error d\'An√†lisi',
    checkConnection: 'Error en analitzar la recepta. Si us plau, verifica la connexi√≥ amb el servidor.',
    verifyConfig: 'Verificar Configuraci√≥',
    apiConfig: 'Configuraci√≥ d\'API',
    audioPermissions: 'Permisos d\'√Äudio',
    microphonePermission: 'Es necessiten permisos de micr√≤fon per usar la funci√≥ de dictat per veu.',
    cameraPermission: 'Es necessiten permisos de c√†mera per fer fotos.',
    galleryPermission: 'Es necessiten permisos de galeria per seleccionar imatges.',
    audioNotAvailable: 'L\'enregistrament d\'√†udio no est√† disponible en aquest navegador. Si us plau, usa Chrome, Edge o Safari.',
    couldNotCreateRecorder: 'No s\'ha pogut crear l\'enregistrador d\'√†udio.',
    couldNotStartRecording: 'No s\'ha pogut iniciar l\'enregistrament. Si us plau, verifica els permisos del micr√≤fon.',
    transcribing: 'Transcrivint',
    processingAudio: 'Processant el teu √†udio amb Whisper...',
    audioTranscribed: '√Äudio transcrit correctament',
    transcriptionError: 'Error de Transcripci√≥',
    errorTranscribing: 'Error en transcribir l\'√†udio. Si us plau, verifica la connexi√≥ amb el servidor.',
    processing: 'Processant',
    extractingText: 'Extraient text de la imatge...',
    textExtracted: 'Text extret correctament de la imatge',
    ocrError: 'Error d\'OCR',
    errorExtractingText: 'Error en extreure text de la imatge. Si us plau, verifica la connexi√≥ amb el servidor.',
    pleaseEnterTitle: 'Si us plau, introdueix un t√≠tol per a la recepta.',
    pleaseEnterText: 'Si us plau, introdueix el text de la recepta.',
    pleaseAnalyzeFirst: 'Si us plau, analitza la recepta primer abans de desar.',
    pleaseSelectCategory: 'Si us plau, selecciona una categoria principal.',
    errorSaving: 'Error en desar la recepta. Si us plau, verifica la connexi√≥ amb Supabase i intenta de nou.',
    connectionError: 'Error de connexi√≥. Si us plau, verifica la teva connexi√≥ a internet.',
    authError: 'Error d\'autenticaci√≥. Si us plau, verifica la configuraci√≥ de Supabase.',
    noIngredientsYet: 'Sense ingredients encara. Executa l\'an√†lisi d\'IA primer.',
    noStepsYet: 'Sense passos encara. Executa l\'an√†lisi d\'IA primer.',
    errorLoadingRecipe: 'Error en carregar la recepta. Si us plau, intenta de nou.',
    errorUpdatingRecipe: 'Error en actualitzar la recepta. Si us plau, intenta de nou.',
    language: 'Idioma',
    selectLanguage: 'Seleccionar Idioma',
    spanish: 'Espanyol',
    catalan: 'Catal√†',
    french: 'Franc√®s',
    english: 'Angl√®s',
    portuguese: 'Portugu√®s',
  },
  fr: {
    appName: 'TuPonesYoComo',
    selectCategory: 'S√©lectionnez une cat√©gorie pour voir les recettes',
    addRecipe: 'Ajouter une Recette',
    recipeDetails: 'D√©tails de la Recette',
    addRecipeTitle: 'Ajouter une Recette',
    editRecipe: 'Modifier la Recette',
    userGuide: 'Guide de l\'Utilisateur',
    recipeTitle: 'Titre de la Recette',
    mainProtein: 'Prot√©ine Principale',
    cuisines: 'Cuisines',
    rawText: 'Texte de la Recette',
    analyze: 'Analyser',
    save: 'Enregistrer',
    cancel: 'Annuler',
    delete: 'Supprimer',
    deleteRecipe: 'Supprimer la Recette',
    edit: 'Modifier',
    servings: 'Portions',
    totalTime: 'Temps Total',
    ovenTime: 'Temps au Four',
    ingredients: 'Ingr√©dients',
    steps: '√âtapes',
    gadgets: 'Ustensiles',
    oven: 'Four',
    for: 'Pour',
    adjustedFrom: 'Ajust√© de',
    portions: 'portions',
    min: 'min',
    record: 'Enregistrer',
    stop: 'Arr√™ter',
    takePhoto: 'Prendre une Photo',
    selectFromGallery: 'S√©lectionner depuis la Galerie',
    scanRecipe: 'Scanner la Recette',
    chooseOption: 'Choisissez une option pour scanner la recette',
    addCategory: 'Ajouter une Cat√©gorie',
    addNewCategory: 'Ajouter une Nouvelle Cat√©gorie',
    categoryName: 'Nom de la cat√©gorie',
    categoryIcon: 'Ic√¥ne (emoji)',
    add: 'Ajouter',
    addNew: 'Ajouter',
    select: 'S√©lectionner',
    other: 'Autre...',
    addCuisine: 'Ajouter une Cuisine',
    addNewCuisine: 'Ajouter une Nouvelle Cuisine',
    cuisineName: 'Nom de la cuisine',
    cuisineFlag: 'Drapeau (emoji)',
    example: 'Ex:',
    optional: 'Optionnel:',
    customizeEmoji: 'personnaliser l\'emoji',
    pasteOrWrite: 'Collez ou √©crivez votre recette ici... Ou utilisez üì∑ pour scanner ou üé§ pour dicter',
    analysisPreview: 'Aper√ßu de l\'Analyse',
    total: 'Total',
    nA: 'N/A',
    success: 'Succ√®s',
    error: 'Erreur',
    categoryAdded: 'Cat√©gorie ajout√©e',
    cuisineAdded: 'Cuisine ajout√©e',
    recipeSaved: 'Recette enregistr√©e',
    recipeDeleted: 'Recette supprim√©e',
    recipeSavedSuccess: 'Recette enregistr√©e avec succ√®s!',
    viewRecipe: 'Voir la Recette',
    backToMainMenu: 'Retour au Menu Principal',
    pleaseEnterName: 'Veuillez entrer un nom',
    pleaseEnterIcon: 'Veuillez entrer une ic√¥ne',
    pleaseEnterFlag: 'Veuillez entrer un emoji de drapeau',
    categoryExists: 'Cette cat√©gorie existe d√©j√†',
    cuisineExists: 'Cette cuisine existe d√©j√†',
    noRecipes: 'Aucune recette dans cette cat√©gorie',
    noRecipesFound: 'Aucune recette trouv√©e',
    tryOtherSearch: 'Essayez avec d\'autres termes de recherche',
    tapAddRecipe: 'Appuyez sur "Ajouter une Recette" pour cr√©er votre premi√®re recette',
    searchPlaceholder: 'Rechercher par nom, cuisine ou ingr√©dient...',
    recipesCount: 'recette',
    recipesCountPlural: 'recettes',
    pullToRefresh: 'Tirez pour actualiser',
    
    // Common UI
    title: 'Titre',
    name: 'Nom',
    add: 'Ajouter',
    save: 'Enregistrer',
    cancel: 'Annuler',
    ok: 'OK',
    reset: 'R√©initialiser',
    loading: 'Chargement...',
    error: 'Erreur',
    success: 'Succ√®s',
    connectingToAI: 'Connexion au serveur IA...',
    processingResponse: 'Traitement de la r√©ponse...',
    recipeAnalyzed: 'Recette analys√©e avec succ√®s!',
    analysisError: 'Erreur d\'Analyse',
    checkConnection: 'Erreur lors de l\'analyse de la recette. Veuillez v√©rifier la connexion au serveur.',
    verifyConfig: 'V√©rifier la Configuration',
    apiConfig: 'Configuration de l\'API',
    audioPermissions: 'Permissions Audio',
    microphonePermission: 'Les permissions du microphone sont n√©cessaires pour utiliser la fonction de dict√©e vocale.',
    cameraPermission: 'Les permissions de la cam√©ra sont n√©cessaires pour prendre des photos.',
    galleryPermission: 'Les permissions de la galerie sont n√©cessaires pour s√©lectionner des images.',
    audioNotAvailable: 'L\'enregistrement audio n\'est pas disponible dans ce navigateur. Veuillez utiliser Chrome, Edge ou Safari.',
    couldNotCreateRecorder: 'Impossible de cr√©er l\'enregistreur audio.',
    couldNotStartRecording: 'Impossible de d√©marrer l\'enregistrement. Veuillez v√©rifier les permissions du microphone.',
    transcribing: 'Transcription',
    processingAudio: 'Traitement de votre audio avec Whisper...',
    audioTranscribed: 'Audio transcrit avec succ√®s',
    transcriptionError: 'Erreur de Transcription',
    errorTranscribing: 'Erreur lors de la transcription de l\'audio. Veuillez v√©rifier la connexion au serveur.',
    processing: 'Traitement',
    extractingText: 'Extraction du texte de l\'image...',
    textExtracted: 'Texte extrait avec succ√®s de l\'image',
    ocrError: 'Erreur OCR',
    errorExtractingText: 'Erreur lors de l\'extraction du texte de l\'image. Veuillez v√©rifier la connexion au serveur.',
    pleaseEnterTitle: 'Veuillez entrer un titre pour la recette.',
    pleaseEnterText: 'Veuillez entrer le texte de la recette.',
    pleaseAnalyzeFirst: 'Veuillez analyser la recette d\'abord avant de l\'enregistrer.',
    pleaseSelectCategory: 'Veuillez s√©lectionner une cat√©gorie principale.',
    errorSaving: 'Erreur lors de l\'enregistrement de la recette. Veuillez v√©rifier la connexion √† Supabase et r√©essayer.',
    connectionError: 'Erreur de connexion. Veuillez v√©rifier votre connexion Internet.',
    authError: 'Erreur d\'authentification. Veuillez v√©rifier la configuration de Supabase.',
    noIngredientsYet: 'Pas encore d\'ingr√©dients. Ex√©cutez d\'abord l\'analyse IA.',
    noStepsYet: 'Pas encore d\'√©tapes. Ex√©cutez d\'abord l\'analyse IA.',
    errorLoadingRecipe: 'Erreur lors du chargement de la recette. Veuillez r√©essayer.',
    errorUpdatingRecipe: 'Erreur lors de la mise √† jour de la recette. Veuillez r√©essayer.',
    language: 'Langue',
    selectLanguage: 'S√©lectionner la Langue',
    spanish: 'Espagnol',
    catalan: 'Catalan',
    french: 'Fran√ßais',
    english: 'Anglais',
    portuguese: 'Portugais',
  },
  en: {
    appName: 'TuPonesYoComo',
    selectCategory: 'Select a category to view recipes',
    addRecipe: 'Add Recipe',
    recipeDetails: 'Recipe Details',
    addRecipeTitle: 'Add Recipe',
    editRecipe: 'Edit Recipe',
    userGuide: 'User Guide',
    recipeTitle: 'Recipe Title',
    mainProtein: 'Main Protein',
    cuisines: 'Cuisines',
    rawText: 'Recipe Text',
    analyze: 'Analyze',
    save: 'Save',
    cancel: 'Cancel',
    delete: 'Delete',
    deleteRecipe: 'Delete Recipe',
    edit: 'Edit',
    servings: 'Servings',
    totalTime: 'Total Time',
    ovenTime: 'Oven Time',
    ingredients: 'Ingredients',
    steps: 'Steps',
    gadgets: 'Utensils',
    oven: 'Oven',
    for: 'For',
    adjustedFrom: 'Adjusted from',
    portions: 'portions',
    min: 'min',
    record: 'Record',
    stop: 'Stop',
    takePhoto: 'Take Photo',
    selectFromGallery: 'Select from Gallery',
    scanRecipe: 'Scan Recipe',
    chooseOption: 'Choose an option to scan the recipe',
    addCategory: 'Add Category',
    addNewCategory: 'Add New Category',
    categoryName: 'Category name',
    categoryIcon: 'Icon (emoji)',
    add: 'Add',
    addNew: 'Add',
    select: 'Select',
    other: 'Other...',
    addCuisine: 'Add Cuisine',
    addNewCuisine: 'Add New Cuisine',
    cuisineName: 'Cuisine name',
    cuisineFlag: 'Flag (emoji)',
    example: 'Ex:',
    optional: 'Optional:',
    customizeEmoji: 'customize emoji',
    pasteOrWrite: 'Paste or write your recipe here... Or use üì∑ to scan or üé§ to dictate',
    analysisPreview: 'Analysis Preview',
    total: 'Total',
    nA: 'N/A',
    success: 'Success',
    error: 'Error',
    categoryAdded: 'Category added',
    cuisineAdded: 'Cuisine added',
    recipeSaved: 'Recipe saved',
    recipeDeleted: 'Recipe deleted',
    recipeSavedSuccess: 'Recipe saved successfully!',
    viewRecipe: 'View Recipe',
    backToMainMenu: 'Back to Main Menu',
    pleaseEnterName: 'Please enter a name',
    pleaseEnterIcon: 'Please enter an icon',
    pleaseEnterFlag: 'Please enter a flag emoji',
    categoryExists: 'This category already exists',
    cuisineExists: 'This cuisine already exists',
    noRecipes: 'No recipes in this category',
    noRecipesFound: 'No recipes found',
    tryOtherSearch: 'Try with other search terms',
    tapAddRecipe: 'Tap "Add Recipe" to create your first recipe',
    searchPlaceholder: 'Search by name, cuisine or ingredient...',
    recipesCount: 'recipe',
    recipesCountPlural: 'recipes',
    pullToRefresh: 'Pull to refresh',
    
    // Common UI
    title: 'Title',
    name: 'Name',
    add: 'Add',
    save: 'Save',
    cancel: 'Cancel',
    ok: 'OK',
    reset: 'Reset',
    loading: 'Loading...',
    error: 'Error',
    success: 'Success',
    connectingToAI: 'Connecting to AI server...',
    processingResponse: 'Processing response...',
    recipeAnalyzed: 'Recipe analyzed successfully!',
    analysisError: 'Analysis Error',
    checkConnection: 'Error analyzing the recipe. Please check the connection to the server.',
    verifyConfig: 'Verify Configuration',
    apiConfig: 'API Configuration',
    audioPermissions: 'Audio Permissions',
    microphonePermission: 'Microphone permissions are required to use the voice dictation feature.',
    cameraPermission: 'Camera permissions are required to take photos.',
    galleryPermission: 'Gallery permissions are required to select images.',
    audioNotAvailable: 'Audio recording is not available in this browser. Please use Chrome, Edge or Safari.',
    couldNotCreateRecorder: 'Could not create audio recorder.',
    couldNotStartRecording: 'Could not start recording. Please check microphone permissions.',
    transcribing: 'Transcribing',
    processingAudio: 'Processing your audio with Whisper...',
    audioTranscribed: 'Audio transcribed successfully',
    transcriptionError: 'Transcription Error',
    errorTranscribing: 'Error transcribing audio. Please check the connection to the server.',
    processing: 'Processing',
    extractingText: 'Extracting text from image...',
    textExtracted: 'Text extracted successfully from image',
    ocrError: 'OCR Error',
    errorExtractingText: 'Error extracting text from image. Please check the connection to the server.',
    pleaseEnterTitle: 'Please enter a title for the recipe.',
    pleaseEnterText: 'Please enter the recipe text.',
    pleaseAnalyzeFirst: 'Please analyze the recipe first before saving.',
    pleaseSelectCategory: 'Please select a main category.',
    errorSaving: 'Error saving recipe. Please check the connection to Supabase and try again.',
    connectionError: 'Connection error. Please check your internet connection.',
    authError: 'Authentication error. Please check Supabase configuration.',
    noIngredientsYet: 'No ingredients yet. Run the AI analysis first.',
    noStepsYet: 'No steps yet. Run the AI analysis first.',
    errorLoadingRecipe: 'Error loading recipe. Please try again.',
    errorUpdatingRecipe: 'Error updating recipe. Please try again.',
    language: 'Language',
    selectLanguage: 'Select Language',
    spanish: 'Spanish',
    catalan: 'Catalan',
    french: 'French',
    english: 'English',
    portuguese: 'Portuguese',
  },
  pt: {
    appName: 'TuPonesYoComo',
    selectCategory: 'Selecione uma categoria para ver receitas',
    addRecipe: 'Adicionar Receita',
    recipeDetails: 'Detalhes da Receita',
    addRecipeTitle: 'Adicionar Receita',
    editRecipe: 'Editar Receita',
    userGuide: 'Guia do Usu√°rio',
    recipeTitle: 'T√≠tulo da Receita',
    mainProtein: 'Prote√≠na Principal',
    cuisines: 'Culin√°rias',
    rawText: 'Texto da Receita',
    analyze: 'Analisar',
    save: 'Salvar',
    cancel: 'Cancelar',
    delete: 'Excluir',
    deleteRecipe: 'Excluir Receita',
    edit: 'Editar',
    servings: 'Por√ß√µes',
    totalTime: 'Tempo Total',
    ovenTime: 'Tempo no Forno',
    ingredients: 'Ingredientes',
    steps: 'Passos',
    gadgets: 'Utens√≠lios',
    oven: 'Forno',
    for: 'Para',
    adjustedFrom: 'Ajustado de',
    portions: 'por√ß√µes',
    min: 'min',
    record: 'Gravar',
    stop: 'Parar',
    takePhoto: 'Tirar Foto',
    selectFromGallery: 'Selecionar da Galeria',
    scanRecipe: 'Escanear Receita',
    chooseOption: 'Escolha uma op√ß√£o para escanear a receita',
    addCategory: 'Adicionar Categoria',
    addNewCategory: 'Adicionar Nova Categoria',
    categoryName: 'Nome da categoria',
    categoryIcon: '√çcone (emoji)',
    add: 'Adicionar',
    addNew: 'Adicionar',
    select: 'Selecionar',
    other: 'Outra...',
    addCuisine: 'Adicionar Culin√°ria',
    addNewCuisine: 'Adicionar Nova Culin√°ria',
    cuisineName: 'Nome da culin√°ria',
    cuisineFlag: 'Bandeira (emoji)',
    example: 'Ex:',
    optional: 'Opcional:',
    customizeEmoji: 'personalizar o emoji',
    pasteOrWrite: 'Cole ou escreva sua receita aqui... Ou use üì∑ para escanear ou üé§ para ditar',
    analysisPreview: 'Pr√©via da An√°lise',
    total: 'Total',
    nA: 'N/A',
    success: 'Sucesso',
    error: 'Erro',
    categoryAdded: 'Categoria adicionada',
    cuisineAdded: 'Culin√°ria adicionada',
    recipeSaved: 'Receita salva',
    recipeDeleted: 'Receita exclu√≠da',
    recipeSavedSuccess: 'Receita salva com sucesso!',
    viewRecipe: 'Ver Receita',
    backToMainMenu: 'Voltar ao Menu Principal',
    pleaseEnterName: 'Por favor, insira um nome',
    pleaseEnterIcon: 'Por favor, insira um √≠cone',
    pleaseEnterFlag: 'Por favor, insira um emoji de bandeira',
    categoryExists: 'Esta categoria j√° existe',
    cuisineExists: 'Esta culin√°ria j√° existe',
    noRecipes: 'Nenhuma receita nesta categoria',
    noRecipesFound: 'Nenhuma receita encontrada',
    tryOtherSearch: 'Tente com outros termos de busca',
    tapAddRecipe: 'Toque em "Adicionar Receita" para criar sua primeira receita',
    searchPlaceholder: 'Buscar por nome, culin√°ria ou ingrediente...',
    recipesCount: 'receita',
    recipesCountPlural: 'receitas',
    pullToRefresh: 'Puxe para atualizar',
    
    // Common UI
    title: 'T√≠tulo',
    name: 'Nome',
    add: 'Adicionar',
    save: 'Salvar',
    cancel: 'Cancelar',
    ok: 'OK',
    reset: 'Redefinir',
    loading: 'Carregando...',
    error: 'Erro',
    success: 'Sucesso',
    connectingToAI: 'Conectando ao servidor de IA...',
    processingResponse: 'Processando resposta...',
    recipeAnalyzed: 'Receita analisada com sucesso!',
    analysisError: 'Erro de An√°lise',
    checkConnection: 'Erro ao analisar a receita. Por favor, verifique a conex√£o com o servidor.',
    verifyConfig: 'Verificar Configura√ß√£o',
    apiConfig: 'Configura√ß√£o da API',
    audioPermissions: 'Permiss√µes de √Åudio',
    microphonePermission: 'Permiss√µes de microfone s√£o necess√°rias para usar a fun√ß√£o de ditado por voz.',
    cameraPermission: 'Permiss√µes de c√¢mera s√£o necess√°rias para tirar fotos.',
    galleryPermission: 'Permiss√µes de galeria s√£o necess√°rias para selecionar imagens.',
    audioNotAvailable: 'Grava√ß√£o de √°udio n√£o est√° dispon√≠vel neste navegador. Por favor, use Chrome, Edge ou Safari.',
    couldNotCreateRecorder: 'N√£o foi poss√≠vel criar o gravador de √°udio.',
    couldNotStartRecording: 'N√£o foi poss√≠vel iniciar a grava√ß√£o. Por favor, verifique as permiss√µes do microfone.',
    transcribing: 'Transcrevendo',
    processingAudio: 'Processando seu √°udio com Whisper...',
    audioTranscribed: '√Åudio transcrito com sucesso',
    transcriptionError: 'Erro de Transcri√ß√£o',
    errorTranscribing: 'Erro ao transcrever o √°udio. Por favor, verifique a conex√£o com o servidor.',
    processing: 'Processando',
    extractingText: 'Extraindo texto da imagem...',
    textExtracted: 'Texto extra√≠do com sucesso da imagem',
    ocrError: 'Erro de OCR',
    errorExtractingText: 'Erro ao extrair texto da imagem. Por favor, verifique a conex√£o com o servidor.',
    pleaseEnterTitle: 'Por favor, insira um t√≠tulo para a receita.',
    pleaseEnterText: 'Por favor, insira o texto da receita.',
    pleaseAnalyzeFirst: 'Por favor, analise a receita primeiro antes de salvar.',
    pleaseSelectCategory: 'Por favor, selecione uma categoria principal.',
    errorSaving: 'Erro ao salvar a receita. Por favor, verifique a conex√£o com Supabase e tente novamente.',
    connectionError: 'Erro de conex√£o. Por favor, verifique sua conex√£o com a internet.',
    authError: 'Erro de autentica√ß√£o. Por favor, verifique a configura√ß√£o do Supabase.',
    noIngredientsYet: 'Sem ingredientes ainda. Execute a an√°lise de IA primeiro.',
    noStepsYet: 'Sem passos ainda. Execute a an√°lise de IA primeiro.',
    errorLoadingRecipe: 'Erro ao carregar a receita. Por favor, tente novamente.',
    errorUpdatingRecipe: 'Erro ao atualizar a receita. Por favor, tente novamente.',
    language: 'Idioma',
    selectLanguage: 'Selecionar Idioma',
    spanish: 'Espanhol',
    catalan: 'Catal√£o',
    french: 'Franc√™s',
    english: 'Ingl√™s',
    portuguese: 'Portugu√™s',
  },
};

// Load saved language
export async function loadLanguage(): Promise<SupportedLanguage> {
  try {
    const savedLanguage = await AsyncStorage.getItem(LANGUAGE_KEY);
    if (savedLanguage && (savedLanguage === 'es' || savedLanguage === 'ca' || savedLanguage === 'fr' || savedLanguage === 'en' || savedLanguage === 'pt')) {
      currentLanguage = savedLanguage as SupportedLanguage;
      return currentLanguage;
    }
  } catch (error) {
    console.error('Error loading language:', error);
  }
  currentLanguage = 'es';
  return 'es';
}

// Save language
export async function saveLanguage(language: SupportedLanguage): Promise<void> {
  try {
    await AsyncStorage.setItem(LANGUAGE_KEY, language);
    currentLanguage = language;
  } catch (error) {
    console.error('Error saving language:', error);
  }
}

// Get current language
export function getCurrentLanguage(): SupportedLanguage {
  return currentLanguage;
}

// Translate function
export function t(key: string, params?: Record<string, any>): string {
  const lang = currentLanguage || 'es';
  const translation = translations[lang]?.[key] || translations['es']?.[key] || key;
  
  // Simple parameter replacement
  if (params) {
    return Object.keys(params).reduce((str, paramKey) => {
      return str.replace(new RegExp(`{{${paramKey}}}`, 'g'), String(params[paramKey]));
    }, translation);
  }
  
  return translation;
}

